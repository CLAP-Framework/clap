<launch>
    <arg name="kitti_bag"/>
    <node pkg="rosbag" type="play" name="data_input"
          args="$(arg kitti_bag) -l -r 0.1"/>
    <node pkg="zzz_perception_detection_lidar_filters" type="extrinsic"
          name="extrinsic_filter" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="/kitti/velo/pointcloud"/>
        <param name="output_topic" value="points_transformed"/>
    </node>
    <node pkg="zzz_perception_detection_lidar_detectors" type="euclidean_cluster"
          name="euclidean_detector" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="points_transformed"/>
        <param name="output_topic" value="objects_detected"/>
    </node>
    <node pkg="zzz_perception_detection_lidar_filters" type="lshape"
          name="euclidean_lshape" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="objects_detected"/>
        <param name="output_topic" value="objects_lshape"/>
    </node>
    <node pkg="zzz_perception_detection_lidar_filters" type="criteria"
          name="euclidean_criteria" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="objects_lshape"/>
        <param name="output_topic" value="objects_filtered"/>
        <param name="min_length_x" value="0.1"/>
        <param name="min_length_y" value="0.1"/>
        <param name="min_length_z" value="0.1"/>
    </node>
    <node pkg="zzz_perception_tracking_object_trackers" type="box_tracker"
          name="box_tracker" output="screen" ns="/zzz/perception">
        <param name="detection_topic" value="objects_filtered"/>
        <param name="tracking_topic" value="objects_tracked"/>
    </node>
    <node pkg="zzz_visualization_rviz_box_visualizer" type="tracking"
          name="box_visualize" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="objects_tracked"/>
        <param name="marker_lifetime" value="0.5"/>
        <param name="box_max_size" value="9999999"/>
    </node>
</launch>
