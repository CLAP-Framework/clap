<launch>
    <arg name='hero_actor' default='ego_vehicle'/>
    <node pkg="topic_tools" type="relay" name="convert_odom" args="/carla/$(arg hero_actor)/odometry /zzz/perception/localization"/>
    <node pkg="topic_tools" type="relay" name="convert_reference_path" args="/carla/$(arg hero_actor)/waypoints /zzz/navigation/reference_path"/>
    <node pkg="zzz_driver_simulators_carla_adapter" type="convert_topic" name="convert_map" output="screen">
        <param name="input_topic" value="/carla/map" />
        <param name="output_topic" value="/zzz/navigation/static_map" />
        <param name="msg_type" value="CarlaMapInfo" />
    </node>

    <node pkg="zzz_perception_detection_lidar_filters" type="extrinsic"
          name="extrinsic_filter" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="/kitti/velo/pointcloud"/>
        <param name="output_topic" value="points_transformed"/>
    </node>
    <node pkg="zzz_perception_detection_lidar_detectors" type="euclidean_cluster"
          name="euclidean_detector" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="points_transformed"/>
        <param name="output_topic" value="objects_detected"/>
    </node>
    <node pkg="zzz_perception_detection_lidar_filters" type="lshape"
          name="euclidean_lshape" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="objects_detected"/>
        <param name="output_topic" value="objects_lshape"/>
    </node>
    <node pkg="zzz_perception_detection_lidar_filters" type="criteria"
          name="euclidean_criteria" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="objects_lshape"/>
        <param name="output_topic" value="objects_filtered"/>
        <param name="min_length_x" value="0.1"/>
        <param name="min_length_y" value="0.1"/>
        <param name="min_length_z" value="0.1"/>
    </node>
    <node pkg="zzz_perception_tracking_object_trackers" type="box_tracker"
          name="box_tracker" output="screen" ns="/zzz/perception">
        <param name="detection_topic" value="objects_filtered"/>
        <param name="tracking_topic" value="objects_tracked"/>
    </node>
    <node pkg="zzz_visualization_rviz_box_visualizer" type="tracking"
          name="box_visualize" output="screen" ns="/zzz/perception">
        <param name="input_topic" value="objects_tracked"/>
        <param name="marker_lifetime" value="0.5"/>
        <param name="box_max_size" value="9999999"/>
    </node>

</launch>
